#### Enumeration
Found website hosted on port 80 through nmap.
![[Pasted image 20230624192507.png]]
![[Pasted image 20230624173237.png]]
This took me to this page.
Looking up this version of cacti leads to a vulnerability![[Pasted image 20230624173443.png]]
https://github.com/FredBrave/CVE-2022-46169-CACTI-1.2.22

This allows us to get a reverse shell for the www-data user. 
![[Pasted image 20230624192730.png]]
There is no python so to stabilize the shell use:
`/usr/bin/script -qc /bin/bash /dev/null`
Ctrl + Z (to background shell)
`stty raw -echo; fg; reset`
`export TERM=xterm`

Running command `find . -perm /4000 2>/dev/null` from the root directory we find all the files with suid bit. 
![[Pasted image 20230624174050.png]]
/sbin/capsh had a exploit.
![[Pasted image 20230624175237.png]]

This allows us to get root on www-data user. However this environment turns out to be a docker container so we do not have actual root privileges. 
We can access mysql through the credentials seen in the entrypoint.sh file:
![[Pasted image 20230624193623.png]]
The database has user_auth data.
![[Pasted image 20230624193803.png]]

Cracking marcus' hash gives a password of funkymonkey.
Attempting to login to marcus' account through ssh works leading to repeated credentials vulnerability.
![[Pasted image 20230624194124.png]]
Marcus has mail describing possible security vulnerabilities. One of which seems unfixed (last one).
![[Pasted image 20230624194220.png]]
Finding all the mounts of the using findmnt on the target machine we can find that path to our initial www-data user shell is in /var/lib/docker/overlay2/c41d5854e43bd996e128d647cb526b73d04c9ad6325201c85f73fdba372cb2f1/merged/tmp
Since we are root on the www-data shell we can create an suid binary that will let us run /bin/bash as root in the marcus' shell.
On www-data docker container:
```
echo bash -c "bash -c '/bin/bash -p' > root.sh"
chmod +sx root.sh
chmod +s /bin/bash
```
On marcus machine:
From tmp directory:
`./root.sh`
From merged directory:
`./bin/bash -p`

![[Pasted image 20230624201039.png]]
